<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="伊﨑 直志" />


<title>Week2 | Rによる自主勉強会</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/simplex.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="site_style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Naoshi <strong>ISAKI</strong></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="univ.html">Univ.</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="js_test.html">jsのテスト</a>
</li>
<li>
  <a href="html_gene.html">Rでhtml生成</a>
</li>
<li>
  <a href="id_class_check.html">タグチェック用</a>
</li>
<li>
  <a href="grid_test.html">gridレイアウト用</a>
</li>
<li>
  <a href="css_test.html">cssチェック用</a>
</li>
<li>
  <a href="rstudy.html">R勉強会</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Week2 | Rによる自主勉強会</h1>
<h4 class="author">伊﨑 直志</h4>
<h4 class="date">2023年10月13日</h4>

</div>


<div id="準備" class="section level1">
<h1>準備</h1>
<div id="loading-packages" class="section level2">
<h2>Loading Packages</h2>
<pre class="r"><code>library(tidyverse)
library(gridExtra)</code></pre>
<pre><code>## 
##  次のパッケージを付け加えます: &#39;gridExtra&#39;</code></pre>
<pre><code>##  以下のオブジェクトは &#39;package:dplyr&#39; からマスクされています: 
## 
##      combine</code></pre>
<pre class="r"><code>windowsFonts(family_sans = windowsFont(&quot;Noto Sans JP&quot;)) 
par(family=&quot;family_sans&quot;)
knitr::opts_chunk$set(echo = TRUE)</code></pre>
</div>
</div>
<div id="第１章-回帰分析の目的" class="section level1">
<h1>第１章　回帰分析の目的</h1>
<div id="相関と因果" class="section level2">
<h2>1.1.　相関と因果</h2>
<ul>
<li><p>相関関係 correlation：「Xが変化すればYも変化する」</p></li>
<li><p>因果関係 causality：「Xを変化させればYも変化する」</p></li>
<li><p>疑似相関 spurious correlation</p>
<p>「変数XとYに共通の第3の要因Zが存在することによってXとYに生じる見せかけの相関関係」</p>
<p>e.g. 個人所得の増加→タバコへの支出増加、医療・健康への支出増加 　
　＝タバコと健康の疑似相関</p></li>
</ul>
<blockquote>
<ul>
<li>時間的先行性:
原因となる現象が結果となる現象に時間的に先立って起きている。</li>
<li>共変関係（相関関係）:
原因となる現象が変動すると、結果となる現象も変動する。</li>
<li>他条件の同一性:
原因となる現象の双方に与える現象は存在しないか、その影響は統制されている。</li>
</ul>
</blockquote>
</div>
<div id="回帰と予測" class="section level2">
<h2>1.2.　回帰と予測</h2>
<ul>
<li><p>一次関数 <span class="math inline">\(y=a+bx\)</span> の形で表現
→最小二乗法（least squares estimation）（図1.1 →図1.6）</p>
<p>回帰直線、回帰式、回帰係数</p></li>
<li><p>回帰式の一方の変数に代入してもう一方の変数の値を計算、予測</p>
<p>＝ある変数Xの値をもとにして、他の変数Yの値を予測　＝回帰分析</p>
<p><code>X：説明変数</code>、<code>Y：被説明変数</code></p></li>
</ul>
<p>⇒因果解釈ではなく、あくまで予測解釈！</p>
<p><strong>回帰分析 →Xが与えられた時のYの値の予測</strong></p>
</div>
<div id="自然科学のデータと社会科学のデータ" class="section level2">
<h2>1.3.　自然科学のデータと社会科学のデータ</h2>
<p>実験の難しさ（費用等コスト、倫理）</p>
<p>⇔自然科学：変数選択の制約・影響少、実験室実験可（変数統制）　[従来的説明]</p>
<p>→現在、社会科学における実験多数：実験経済学等 or
自然実験…（後述）</p>
<hr />
</div>
</div>
<div id="第２章-統計の基礎知識" class="section level1">
<h1>第２章　統計の基礎知識</h1>
<div id="母集団と標本" class="section level2">
<h2>2.1. 母集団と標本</h2>
<p>-（有限集団全体）母集団－（抽出）標本 -
（確率分布）母集団－（観測値）標本　（←本書）</p>
<p>正規分布 normal distribution</p>
<p>正規分布<span class="math inline">\(N(平均,
分散=標準偏差^2)\)</span></p>
<p>正規分布（乱数）: <code>rnorm(個数, 平均, 標準偏差)</code></p>
<pre class="r"><code>rnorm(100, 50, 10) </code></pre>
<pre><code>##   [1] 45.60604 67.87135 44.14586 37.04399 30.37390 56.73465 65.66981 57.44355
##   [9] 52.84252 65.07393 53.30466 44.72347 58.84394 39.73733 47.39524 53.42753
##  [17] 61.50782 68.96929 56.48562 48.05567 39.55060 46.50734 31.45467 53.96269
##  [25] 58.34240 36.31948 26.59525 52.76290 51.94213 52.81111 51.35231 59.97599
##  [33] 51.08780 45.83121 59.20986 43.69913 49.83635 61.92557 58.89481 76.06347
##  [41] 65.29391 61.48301 46.53370 39.06179 43.33960 41.93371 50.93197 35.66812
##  [49] 37.42269 49.56677 72.53858 59.85744 22.92601 54.97209 53.87005 48.89596
##  [57] 43.28938 54.96527 50.49307 30.65171 82.05461 38.21908 42.08604 47.42289
##  [65] 63.90865 50.31716 45.28509 50.61403 56.88179 41.63998 50.90437 34.05554
##  [73] 53.01218 46.30122 53.99484 54.44199 41.98452 44.49919 41.61828 44.20682
##  [81] 35.04024 50.42408 54.65727 50.37177 57.75484 63.34257 54.60541 53.83606
##  [89] 48.34002 54.97456 51.18152 44.26136 41.27661 67.05158 44.35946 41.25055
##  [97] 55.91407 34.54358 41.06917 46.27704</code></pre>
<pre class="r"><code>curve(dnorm(x, 50, 10), 0, 100)　#正規分布のグラフ描画</code></pre>
<p><img src="rweek2_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<pre class="r"><code>pnorm(60, 50, 10) #大きさ１の標本の値が60より小さくなる確率</code></pre>
<pre><code>## [1] 0.8413447</code></pre>
<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>命令</th>
<th>説明</th>
<th>（英略）</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>rnorm(n, a, b)</code></td>
<td>平均a, 標準偏差bの正規分布乱数をn個発生させる。</td>
<td>random+norm</td>
</tr>
<tr class="even">
<td><code>dnorm(x, a, b)</code></td>
<td>平均a, 標準偏差bの正規分布について,
密度関数の点xにおける値を計算する。</td>
<td>density+norm</td>
</tr>
<tr class="odd">
<td><code>pnorm(x, a, b)</code></td>
<td>平均a, 標準偏差bの正規分布について,
分布関数の点xにおける値を計算する。</td>
<td>probability+norm</td>
</tr>
</tbody>
</table>
<p>正規分布グラフ 描画関数</p>
<p><code>curve(dnorm(x, a, b), min, max)</code> #curve(関数の式,
横軸の最小値, 横軸の最大値)</p>
</div>
<div id="無作為抽出" class="section level2">
<h2>2.2.　無作為抽出</h2>
<p>母集団から標本を抽出（random sampling）</p>
<pre class="r"><code>rnorm(100, 50, 10)</code></pre>
<pre><code>##   [1] 42.83631 63.11650 48.22667 46.91929 45.60600 57.14245 50.59649 60.54288
##   [9] 54.28855 56.13806 50.42904 63.21392 61.61565 36.01224 25.74624 68.80907
##  [17] 44.23544 46.02678 44.56605 42.20782 37.50569 49.12500 47.71001 58.90353
##  [25] 46.30064 51.05020 50.93463 71.75628 48.64524 40.75880 63.97976 56.06747
##  [33] 41.08782 54.69738 45.60282 48.56230 37.03992 40.13120 63.85375 39.84772
##  [41] 42.38136 47.26292 38.48383 58.00536 38.90047 68.55538 38.82468 65.88810
##  [49] 61.21150 51.88125 54.34544 53.78964 28.43120 65.22424 45.84940 50.55002
##  [57] 53.15825 49.22894 50.16603 42.06853 57.79855 56.31421 43.78036 61.88960
##  [65] 31.66884 49.19659 56.38571 58.39175 53.83106 51.65934 77.02429 25.70510
##  [73] 55.46175 76.08686 51.29278 48.76730 41.45633 58.75931 71.08234 58.49103
##  [81] 58.16955 43.32820 58.92306 47.49801 49.73147 62.53923 39.43561 56.12235
##  [89] 52.26853 49.40502 50.54168 54.09999 58.74187 41.16386 64.43131 63.47620
##  [97] 71.48257 53.58919 52.07931 46.13743</code></pre>
<pre class="r"><code>Z &lt;- rnorm(100, 50, 10)
Z</code></pre>
<pre><code>##   [1] 56.61688 50.86830 47.76214 69.09924 69.63677 47.03000 61.63179 30.94020
##   [9] 36.01854 51.07826 54.86128 49.67855 46.32335 63.18205 38.44250 55.20911
##  [17] 57.57369 51.60422 44.67217 57.63321 54.88664 48.38102 55.56041 56.49711
##  [25] 52.39141 33.79911 33.48819 38.24881 47.91738 67.55072 56.39049 58.13203
##  [33] 64.06107 54.25553 59.54930 54.71465 63.08314 46.85412 45.28651 47.13794
##  [41] 30.25376 51.64730 43.65704 36.50862 37.99099 65.81544 43.08646 50.93364
##  [49] 68.91077 54.44760 47.98460 59.24366 43.55095 54.53438 35.58236 41.12527
##  [57] 45.05284 62.48888 51.42658 37.15805 39.82432 37.64171 68.19042 61.84804
##  [65] 49.34751 61.96906 61.04202 50.97620 59.55859 38.90338 38.71534 52.00358
##  [73] 53.42632 55.21407 48.26013 47.39264 48.67640 41.79537 51.37654 46.50381
##  [81] 74.36417 63.99467 61.31847 35.31998 63.09304 57.40921 53.93433 56.14380
##  [89] 64.23703 58.54240 42.89179 45.45470 67.00403 40.66425 37.39461 60.69329
##  [97] 48.85745 59.65265 47.41695 59.44789</code></pre>
<pre class="r"><code>hist(Z) #ヒストグラム</code></pre>
<p><img src="rweek2_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>Z[1:10] #最初の10個のデータを抜き出し</code></pre>
<pre><code>##  [1] 56.61688 50.86830 47.76214 69.09924 69.63677 47.03000 61.63179 30.94020
##  [9] 36.01854 51.07826</code></pre>
<pre class="r"><code>a &lt;- c(5, 10, 100)
Z[a] #5番目,10番目,100番目の位置にある数字を抜き出し</code></pre>
<pre><code>## [1] 69.63677 51.07826 59.44789</code></pre>
<pre class="r"><code>Z[c(5, 10, 100)] #aを使わずに同上の操作</code></pre>
<pre><code>## [1] 69.63677 51.07826 59.44789</code></pre>
<pre class="r"><code>#特定の意味を持つ数値を抽出
max(Z) #最大値</code></pre>
<pre><code>## [1] 74.36417</code></pre>
<pre class="r"><code>which.max(Z) #最大値の位置</code></pre>
<pre><code>## [1] 81</code></pre>
<pre class="r"><code>min(Z) #最小値</code></pre>
<pre><code>## [1] 30.25376</code></pre>
<pre class="r"><code>which.min(Z) #最小値の位置</code></pre>
<pre><code>## [1] 41</code></pre>
<pre class="r"><code>mean(Z) #平均値</code></pre>
<pre><code>## [1] 51.49947</code></pre>
<pre class="r"><code>summary(Z) #基本統計量を一括表示</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   30.25   44.96   51.52   51.50   59.29   74.36</code></pre>
<pre class="r"><code>1:10</code></pre>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<pre class="r"><code>sample(1:10, 3) #無作為抽出、sample(範囲, 抽出個数)</code></pre>
<pre><code>## [1]  4 10  2</code></pre>
<pre class="r"><code>sample(Z, 5) #sample(標本, 抽出個数)</code></pre>
<pre><code>## [1] 48.38102 43.08646 45.05284 68.91077 52.00358</code></pre>
<pre class="r"><code>sample(Z, 5) #sample(標本, 抽出個数)</code></pre>
<pre><code>## [1] 59.55859 46.50381 55.56041 33.79911 61.63179</code></pre>
<pre class="r"><code>fruits &lt;- c(&quot;ミカン&quot;, &quot;バナナ&quot;, &quot;リンゴ&quot;, &quot;レモン&quot;, &quot;モモ&quot;)
fruits</code></pre>
<pre><code>## [1] &quot;ミカン&quot; &quot;バナナ&quot; &quot;リンゴ&quot; &quot;レモン&quot; &quot;モモ&quot;</code></pre>
<pre class="r"><code>sample(fruits, 1) #fruitsから1個抽出</code></pre>
<pre><code>## [1] &quot;レモン&quot;</code></pre>
<pre class="r"><code>sample(fruits, 2) #fruitsから2個抽出</code></pre>
<pre><code>## [1] &quot;リンゴ&quot; &quot;バナナ&quot;</code></pre>
<pre class="r"><code>sample(fruits, 1) #fruitsから1個抽出</code></pre>
<pre><code>## [1] &quot;バナナ&quot;</code></pre>
<pre class="r"><code>sample(fruits, 1) #fruitsから1個抽出</code></pre>
<pre><code>## [1] &quot;バナナ&quot;</code></pre>
<p>コイン投げ<a href="#fn1" class="footnote-ref"
id="fnref1"><sup>1</sup></a></p>
<pre class="r"><code>coin &lt;- c(&quot;Head&quot;, &quot;Tail&quot;) 
#sample(coin, 5) #うまくいかない　∵非復元抽出になっている
sample(coin, 5, replace = TRUE) #復元抽出, replace=TRUE</code></pre>
<pre><code>## [1] &quot;Head&quot; &quot;Tail&quot; &quot;Head&quot; &quot;Head&quot; &quot;Head&quot;</code></pre>
</div>
<div id="平均と大数の法則" class="section level2">
<h2>2.3.　平均と大数の法則</h2>
<ul>
<li>①ベクトルrecのi番目の場所rec[i]に</li>
<li>②母集団N(50,10^2)から抜き出した大きさ100の標本の平均を格納する</li>
</ul>
<pre class="r"><code>mean(Z) #標本平均</code></pre>
<pre><code>## [1] 51.49947</code></pre>
<pre class="r"><code>mean(rnorm(100, 50, 10))</code></pre>
<pre><code>## [1] 50.75418</code></pre>
<pre class="r"><code>mean(rnorm(100, 50, 10)) #Z&lt;-rnorm(100,50,10)</code></pre>
<pre><code>## [1] 52.19866</code></pre>
<pre class="r"><code>#より多い試行、抽出1000回、標本の大きさ100
S &lt;- 1000
rec1 &lt;- numeric(S)
for(i in 1:S){rec1[i]&lt;-mean(rnorm(100, 50, 10))}
rec1</code></pre>
<pre><code>##    [1] 49.94874 49.42061 50.27203 50.67633 50.36196 48.55255 51.60209 47.92373
##    [9] 49.31595 50.89470 51.10509 50.02249 48.84490 51.85066 49.10782 51.20182
##   [17] 48.39682 49.61584 50.11326 49.41260 49.62359 49.71579 50.32012 48.67728
##   [25] 47.35920 50.45969 51.72784 50.56323 49.53681 51.37261 48.98257 49.46142
##   [33] 51.24370 49.66299 48.94644 50.06775 47.77094 51.03247 50.90938 50.43309
##   [41] 50.02115 52.99843 49.96453 50.23480 50.04460 50.18004 49.39195 49.60655
##   [49] 50.76697 49.64855 49.23296 50.58413 49.29735 48.93651 46.84886 49.11250
##   [57] 49.60107 47.94392 51.70705 49.80381 50.88423 50.85578 51.17311 48.68546
##   [65] 50.22713 50.20097 50.76879 48.95764 50.69270 50.65460 48.75896 50.06949
##   [73] 50.07834 49.70277 51.51532 49.54236 49.21415 50.61924 49.81277 49.20092
##   [81] 49.51205 51.66504 48.11063 51.33746 49.99721 48.35508 48.55042 49.16645
##   [89] 48.06069 49.57365 49.26215 49.87237 51.22065 48.59502 48.11374 48.95310
##   [97] 49.94516 50.22162 49.60345 49.49532 49.39546 48.85752 49.71384 50.61419
##  [105] 48.47574 49.05505 50.30034 50.73112 49.29055 50.50705 50.07850 51.28762
##  [113] 48.38807 52.17016 49.91372 49.25922 51.22502 50.39471 49.81687 49.52873
##  [121] 49.17193 50.15984 50.47792 49.42482 51.28080 48.76768 49.04437 49.00135
##  [129] 49.67933 48.88948 50.69967 48.40662 51.37443 50.76507 50.06488 50.14273
##  [137] 50.16415 51.58875 50.35487 51.11593 49.98888 51.63501 51.51967 50.86432
##  [145] 51.75537 50.45192 48.75547 52.23493 49.51737 49.45481 50.31012 49.98369
##  [153] 49.78451 49.95520 49.28305 50.21105 50.39592 50.30218 50.76502 48.86589
##  [161] 51.86184 49.97719 49.99558 48.49584 49.03808 51.18836 49.66965 50.53234
##  [169] 50.58426 50.98418 50.27533 49.57426 50.36105 49.47873 50.00986 52.14704
##  [177] 49.12872 49.96370 47.85695 52.03211 51.60296 49.34861 50.01136 49.92033
##  [185] 52.43039 48.67151 51.07706 50.16361 51.15294 50.34310 51.02683 50.88952
##  [193] 50.55758 50.95052 49.67129 49.85309 48.49171 50.77317 53.39099 49.92003
##  [201] 48.85566 52.21298 48.97651 49.38109 49.93026 50.41170 49.11390 51.41297
##  [209] 50.89780 49.72811 51.73825 51.92445 49.92773 48.38160 50.37889 47.95998
##  [217] 49.30029 49.58805 49.69629 50.08680 51.63242 48.44642 49.90855 51.11565
##  [225] 52.75487 47.26871 48.41279 51.64534 50.86864 50.52838 49.66508 49.76137
##  [233] 49.99013 50.52397 52.31405 50.42638 49.92232 49.89551 48.64252 52.29328
##  [241] 50.10419 51.84114 48.09556 48.84047 49.53205 48.86135 51.01099 48.47728
##  [249] 50.85737 50.24932 49.65480 50.69950 47.96584 50.63969 49.65083 51.38948
##  [257] 51.53326 49.77592 51.20384 48.54163 50.00392 49.41702 51.60354 50.16953
##  [265] 50.39762 49.40961 49.72388 51.22829 46.16260 51.68513 51.27761 49.85266
##  [273] 50.74071 47.94360 50.55535 51.12160 49.50699 50.91551 51.03854 49.92274
##  [281] 49.51422 50.75234 48.87547 50.20985 50.29004 50.16661 50.09814 50.53423
##  [289] 51.23467 49.07751 50.39814 48.94597 50.64140 51.00738 50.32492 51.60039
##  [297] 49.78658 48.97002 51.27159 48.12956 49.97172 50.50225 50.08337 50.23739
##  [305] 49.38970 48.94584 48.57587 50.75656 48.25405 49.46198 51.22117 50.63425
##  [313] 49.57963 50.23181 50.22922 48.89206 48.26380 49.64236 49.71591 49.56172
##  [321] 49.43802 50.43384 50.93467 49.59541 49.25197 50.43221 50.44291 49.91461
##  [329] 49.99086 50.16357 49.94549 47.92532 50.27457 48.46579 50.08492 51.00528
##  [337] 50.67215 49.53461 48.40080 49.67812 52.63465 50.54369 49.07392 49.52352
##  [345] 48.94981 48.83173 51.54755 50.52016 49.75699 50.06020 49.04106 49.15886
##  [353] 50.60205 50.75281 49.11353 50.40979 49.96387 48.89858 51.15156 50.75850
##  [361] 50.35010 49.31920 50.44764 48.45953 50.47121 51.52374 50.48031 50.70196
##  [369] 49.94417 51.21867 50.43714 49.54475 50.21706 47.78179 49.04131 49.40635
##  [377] 50.46502 52.51934 50.28115 48.81644 49.07635 49.91493 47.74551 51.00351
##  [385] 49.82853 48.32066 50.48715 50.13311 51.29699 50.91473 53.29329 49.75440
##  [393] 49.18538 50.39528 50.27815 50.89245 47.92713 50.94207 50.23642 48.96138
##  [401] 51.19753 48.48124 49.23793 46.96343 49.00137 51.29485 49.52151 49.68454
##  [409] 52.32566 50.27128 50.12003 49.62553 51.07070 50.86843 51.51185 49.04583
##  [417] 50.85677 49.43727 51.82365 49.55834 50.55958 50.84995 50.56047 49.01111
##  [425] 49.68303 49.17159 48.92309 51.57836 49.91969 50.62514 48.69805 50.35849
##  [433] 48.88338 51.81417 50.28869 50.14785 49.53743 50.77250 51.00293 48.43387
##  [441] 48.82148 51.42182 50.79586 49.26915 49.97346 50.55169 49.82713 51.17268
##  [449] 51.00550 49.86886 50.08056 47.16078 51.46503 48.80453 50.68144 50.92406
##  [457] 51.06063 49.53409 49.76074 49.99059 48.50054 50.07274 51.72723 49.81875
##  [465] 50.27310 52.64216 48.51623 49.95605 50.50980 50.60030 50.68188 52.42589
##  [473] 48.77150 49.72399 50.67088 50.70387 51.79840 48.62204 51.64254 50.05786
##  [481] 50.16705 49.61355 48.69053 49.97887 49.53192 49.17510 49.67611 50.38099
##  [489] 50.28830 49.48900 49.12848 50.48276 49.65380 50.07560 51.14799 49.77154
##  [497] 48.46456 50.82501 51.15823 49.67939 50.37904 51.94361 49.53690 48.25469
##  [505] 51.66998 51.02709 50.38116 50.58386 49.39718 48.82085 51.46513 49.76217
##  [513] 49.61476 50.00982 52.08100 50.27626 50.55079 51.71807 48.95578 48.33468
##  [521] 51.39780 47.92894 49.49056 49.03448 49.17965 48.92349 49.28528 50.39969
##  [529] 50.85885 48.78567 48.75500 49.56059 50.21654 49.26353 49.80469 49.54142
##  [537] 48.99181 51.01763 50.80637 49.45194 50.36249 48.47581 51.44061 48.98323
##  [545] 52.75444 49.55821 50.02449 48.58076 49.72926 49.90270 47.86301 50.25189
##  [553] 50.60999 51.45928 50.80440 49.49874 48.32318 50.24459 50.94906 49.96675
##  [561] 50.68028 51.36865 50.49284 49.34918 50.26648 50.68980 48.44151 51.50652
##  [569] 49.31536 51.00202 49.23612 50.93637 49.21971 50.38881 50.48955 48.86691
##  [577] 49.49523 48.85601 50.42495 49.55896 50.49503 51.03502 49.95991 48.29953
##  [585] 49.00863 50.51749 48.94648 48.70381 51.14999 50.58439 49.53047 49.29343
##  [593] 49.60581 49.13688 51.15822 50.82553 50.39521 49.86627 49.52813 49.35088
##  [601] 51.93773 50.57093 49.55823 49.61422 50.82500 51.00724 50.29750 47.96352
##  [609] 51.09641 50.93289 50.52203 50.49673 50.16394 49.32479 49.96546 50.91818
##  [617] 49.77639 49.03661 50.55097 51.42767 49.28504 48.99587 50.83335 50.62605
##  [625] 51.16774 50.55282 50.61961 48.01661 50.32793 51.03551 50.60928 50.67750
##  [633] 50.50687 49.49892 51.35294 49.63618 47.77903 49.44267 49.66575 51.38357
##  [641] 48.84438 50.75685 51.79903 51.39544 49.95913 48.92258 50.95793 50.09968
##  [649] 48.14725 48.92184 47.61699 50.20796 49.93171 49.71656 50.07527 49.73972
##  [657] 48.90841 52.23989 50.55257 51.72447 49.14876 49.34016 51.80546 50.92009
##  [665] 51.08525 48.84405 50.06747 50.86774 50.09309 48.95288 48.28178 48.41113
##  [673] 49.39637 50.37600 51.49802 48.89979 49.73650 48.14117 48.34363 47.78520
##  [681] 48.42805 49.78641 48.88993 49.90579 51.47109 49.06654 49.96105 49.49448
##  [689] 49.21814 50.04666 50.16362 49.63503 50.56168 49.63626 48.41921 48.29315
##  [697] 48.61284 50.29569 49.09388 49.91369 50.28913 49.99072 50.61681 50.28984
##  [705] 50.43686 49.81061 50.33382 49.68220 52.59151 49.70394 49.05148 49.48193
##  [713] 48.95765 49.26719 50.72654 50.42386 50.07867 49.58093 49.81023 52.13842
##  [721] 50.26920 48.49179 51.54110 49.22803 51.17408 50.44015 49.37470 47.93496
##  [729] 49.76827 49.48817 50.96571 50.64579 48.91811 49.10830 48.79008 50.58164
##  [737] 49.89317 52.22703 50.92947 49.92286 50.87178 48.77605 47.60511 50.43658
##  [745] 51.07038 49.87429 50.18140 49.61325 50.65588 49.50304 49.21917 49.04892
##  [753] 49.69424 50.59862 51.12677 49.68278 50.22539 50.53489 52.09394 52.30901
##  [761] 48.01596 49.60988 50.34894 49.93288 49.10994 48.04853 50.89445 48.14760
##  [769] 51.28879 49.98876 51.25596 49.40229 51.56480 49.78540 50.98762 48.62702
##  [777] 51.27137 50.21546 51.15815 50.06072 50.01321 50.19506 50.17138 47.97070
##  [785] 50.45344 51.02214 51.28152 50.49449 50.75945 49.55698 48.36355 49.62288
##  [793] 51.47181 50.27945 50.86340 51.04866 50.52084 50.32877 49.82262 50.42129
##  [801] 49.53538 50.50484 50.69950 48.88938 50.12878 49.39707 51.55969 51.14066
##  [809] 48.70673 50.60366 48.88596 49.75985 48.16275 50.39666 49.40956 49.89753
##  [817] 50.18718 48.07022 49.84497 49.05630 50.51660 50.68473 50.11732 50.09937
##  [825] 48.77093 50.12053 48.58834 51.07930 50.85459 51.10370 50.68486 49.38241
##  [833] 47.78555 48.60104 50.84795 50.67851 48.06462 50.58793 49.86060 50.65261
##  [841] 50.16458 49.21742 49.70121 50.15455 50.20672 50.40283 50.18668 50.29637
##  [849] 49.90084 48.76025 50.94952 50.01437 49.45886 49.98408 49.48268 49.31059
##  [857] 51.73939 50.91810 50.51339 51.61468 49.89530 48.72538 50.79987 51.00249
##  [865] 51.45699 49.30133 51.61946 50.36409 53.17376 49.68844 50.92091 49.93918
##  [873] 50.05975 49.43021 50.46327 52.27407 48.79995 49.64223 50.55341 49.24846
##  [881] 51.19493 50.08849 50.70562 50.64290 50.09071 51.61790 51.10386 49.74957
##  [889] 51.04672 51.13620 51.45662 52.19328 49.42352 49.01510 49.91650 51.14077
##  [897] 49.74206 49.83641 49.28292 49.45954 51.26654 50.98892 50.09864 50.25758
##  [905] 49.12389 50.15218 49.56687 50.38851 50.97716 49.95713 50.43599 50.86937
##  [913] 49.45012 50.82343 49.94198 50.63487 49.85923 51.00152 49.65868 50.55089
##  [921] 50.12958 51.35512 50.60355 50.70149 50.18718 49.34961 50.44814 50.25375
##  [929] 48.44136 50.75046 49.83806 49.41248 49.51792 49.26434 49.84271 49.99414
##  [937] 50.55770 50.05569 51.27937 49.97616 50.21979 50.38479 50.48669 47.83317
##  [945] 50.77594 51.90681 52.49893 48.81714 49.88541 50.54998 49.88170 49.50945
##  [953] 49.07191 50.18453 50.78136 52.66438 49.86050 48.48533 50.33715 48.50124
##  [961] 49.16804 52.18918 50.11269 49.53724 49.15068 49.63972 51.65027 49.41425
##  [969] 50.54010 48.20108 50.34743 51.03607 50.09015 49.64592 50.08832 50.37474
##  [977] 47.68956 49.24925 50.83185 48.42129 49.72443 49.21338 49.44766 49.75737
##  [985] 49.57287 49.80311 50.46161 51.78278 50.59442 50.70210 49.37262 50.32354
##  [993] 50.55766 50.50052 50.44741 49.52658 48.81902 51.45656 48.11712 51.23076</code></pre>
<pre class="r"><code>hist(rec1, main = &quot;n = 100&quot;) #main = &quot;n = 100&quot;, ラベル</code></pre>
<p><img src="rweek2_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>summary(rec1)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   46.16   49.38   50.06   50.04   50.70   53.39</code></pre>
<blockquote>
<p>【大数の法則】
母集団から無作為に抜き出された標本の平均値は、標本の大きさが大きいほど、母集団平均に近い値をとる。</p>
</blockquote>
<p>サイコロ：母集団平均3.5</p>
<p><span
class="math inline">\(1*1/6+2*1/6+3*1/6+4*1/6+5*1/6+6*1/6=3.5\)</span></p>
<p>⇒大数の法則をスクリプトで確認</p>
<pre class="r"><code>sample(1:6, 10, replace = TRUE) #サイコロを10回振る試行</code></pre>
<pre><code>##  [1] 1 5 4 2 5 5 1 2 1 5</code></pre>
<pre class="r"><code>mean(sample(1:6, 1000, replace = TRUE)) #サイコロを1000回振った結果の目の平均値, 3.5に近似</code></pre>
<pre><code>## [1] 3.407</code></pre>
<pre class="r"><code>#サイコロ10回の標本平均×1000
S &lt;- 1000
rec2 &lt;- numeric(S)
for(i in 1:S){rec2[i] &lt;- mean(sample(1:6, 10, replace = TRUE))} #サイコロ10回の標本平均×1000
summary(rec2)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   1.800   3.200   3.500   3.505   3.900   5.500</code></pre>
<pre class="r"><code>#サイコロ1000回の標本平均×1000
S &lt;- 1000
rec3 &lt;- numeric(S)
for(i in 1:S){rec3[i]&lt;-mean(sample(1:6, 1000,replace=TRUE))} #サイコロ1000回の標本平均×1000
summary(rec3)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   3.326   3.464   3.501   3.500   3.536   3.683</code></pre>
<pre class="r"><code>#サイコロ10000回の標本平均×1000
S &lt;- 1000
rec4 &lt;- numeric(S)
for(i in 1:S){rec4[i] &lt;- mean(sample(1:6, 10000, replace = TRUE))} #サイコロ1000回の標本平均×10000
summary(rec4)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   3.429   3.489   3.500   3.500   3.512   3.555</code></pre>
<p><a href="https://cognicull.com/ja/kdeqdxtn">参考: 大数の法則とは -
Cognicull</a></p>
</div>
<div id="分散と標準偏差" class="section level2">
<h2>2.4.　分散と標準偏差</h2>
<table>
<thead>
<tr class="header">
<th><code>var()</code></th>
<th>分散</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>sd()</code></td>
<td>標準偏差</td>
</tr>
</tbody>
</table>
<p>標本平均 →標本のちらばり</p>
<ul>
<li>分散 variance
標本が平均値を中心にどれだけ散らばっているかを表す指標</li>
<li>標準偏差 standard deviaton
分散の平方根、標本が平均値を中心にどれだけ散らばっているかを表す指標（同上）
<a href="https://cognicull.com/ja/et7cim2q">参考</a></li>
</ul>
<blockquote>
<p>分散は、計算過程において２乗しているので観測データの単位と異なります。例えば観測データの単位がg（グラム）である場合、分散の単位はg2になります。そこで、分散の平方根である標準偏差を求めることによって、観測データとの単位を揃えることが出来ます。そうすることで、分散よりも扱いやすい値となります。
<a
href="https://ai-trend.jp/basic-study/basic/standard-deviation/">出典:
標準偏差の意味と求め方 | AVILEN AI Trend</a></p>
</blockquote>
<pre class="r"><code>#母集団N(50, 10^2)から大きさ1000の標本を無作為に抽出
x &lt;- rnorm(1000, 50, 10)
var(x) #分散</code></pre>
<pre><code>## [1] 96.00405</code></pre>
<pre class="r"><code>sd(x) #標準偏差 #10に近似</code></pre>
<pre><code>## [1] 9.798166</code></pre>
<pre class="r"><code>#分散・標準偏差における大数の法則
#n = 1000
S &lt;- 1000; n &lt;- 1000
rec &lt;- numeric(S)
for(i in 1:S){rec[i]&lt;-sd(rnorm(n, 50, 10))}
summary(rec) #標準偏差10に近似</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   9.389   9.836   9.993   9.995  10.138  10.753</code></pre>
<pre class="r"><code>#より大きいサイズで確認
#n = 10000
S &lt;- 10000; n &lt;- 10000
rec &lt;- numeric(S)
for(i in 1:S){rec[i]&lt;-sd(rnorm(n, 50, 10))}
summary(rec) #より10に近似＝大数の法則</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   9.756   9.955  10.001  10.002  10.048  10.295</code></pre>
</div>
<div id="相関係数と共分散" class="section level2">
<h2>2.5.　相関係数と共分散</h2>
<table>
<thead>
<tr class="header">
<th><code>plot()</code></th>
<th>散布図</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>cor()</code></td>
<td>相関係数</td>
</tr>
<tr class="even">
<td><code>cov()</code></td>
<td>共分散</td>
</tr>
</tbody>
</table>
<pre class="r"><code>x &lt;- rnorm(100, 50, 10)
y &lt;- rnorm(100, 50, 10)
plot(x, y, main = &quot;散布図(x, y)&quot;) #x,yの散布図</code></pre>
<p><img src="rweek2_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code>#xと関係のあるzを追加
z &lt;- (x+y)/2
plot(x, z, main = &quot;散布図(x,z)&quot;) #x,zの散布図</code></pre>
<p><img src="rweek2_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<ul>
<li><p>共分散: 2変数の関係の強さを表す指標の一つ。</p>
<p>〈手順〉</p>
<ol style="list-style-type: decimal">
<li>それぞれの変数の平均値を求める</li>
<li>それぞれの変数の偏差（数値 － 平均値）を求める</li>
<li>偏差の積の平均値（＝共分散）を計算する</li>
</ol>
<p>ただし、データの単位の影響を受けるので値の大きさで単純に比較できない（データスケールに応じて変
化してしまい、共分散の数値だけを見て関係性を判断することは難しい）</p>
<p>⇒ 正規化・標準化の必要＝相関係数</p></li>
<li><p>相関係数: 2つの確率変数間の線形関係の強さをはかる指標、</p>
<p>-1以上+1以下の値を取り、1に近づくほど正の相関、-1に近づくほど負の相関</p></li>
</ul>
<pre class="r"><code>x &lt;- rnorm(100, 50, 10)
y &lt;- rnorm(100, 50, 10)
plot(x, y, main = &quot;散布図(x, y)&quot;) #x, yの散布図</code></pre>
<p><img src="rweek2_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>z &lt;- (x+y)/2 #xと関係のあるzを追加
plot(x, z, main = &quot;散布図(x,z)&quot;) #x, zの散布図</code></pre>
<p><img src="rweek2_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<div id="相関係数" class="section level3">
<h3>相関係数</h3>
<pre class="r"><code>cor(x, y)</code></pre>
<pre><code>## [1] -0.06163847</code></pre>
<pre class="r"><code>cor(x, z)</code></pre>
<pre><code>## [1] 0.6499237</code></pre>
</div>
<div id="共分散" class="section level3">
<h3>共分散</h3>
<pre class="r"><code>cov(x, y)</code></pre>
<pre><code>## [1] -7.413642</code></pre>
<pre class="r"><code>cov(x, z)</code></pre>
<pre><code>## [1] 51.33012</code></pre>
</div>
<div id="おまけ" class="section level3">
<h3>おまけ</h3>
<pre class="r"><code>x &lt;- rnorm(100, 50, 10)
y &lt;- rnorm(100, 50, 10)
par(family=&quot;family_sans&quot;)
plot(x, y, main = &quot;散布図(x, y)&quot;) #x, yの散布図</code></pre>
<p><img src="rweek2_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code>z &lt;- (x+y)/2 #xと関係のあるzを追加
plot(x, z, main = &quot;散布図(x, z)&quot;) #x,zの散布図</code></pre>
<p><img src="rweek2_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
<pre class="r"><code>library(ggplot2)
ggplot() +
  geom_point(aes(x, y))+
  labs(title=&quot;散布図(x, y)&quot;) +
  theme_grey(base_family = &quot;family_sans&quot;) +
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="rweek2_files/figure-html/unnamed-chunk-12-3.png" width="672" /></p>
<pre class="r"><code>ggplot() +
  geom_point(aes(x, z)) +
  labs(title=&quot;散布図(x, z)&quot;) +
  theme_grey(base_family = &quot;family_sans&quot;) +
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="rweek2_files/figure-html/unnamed-chunk-12-4.png" width="672" /></p>
<pre class="r"><code>ggplot() +
  geom_point(aes(x, y)) +
  labs(title=&quot;散布図(x, y)&quot;) +
  theme_bw(base_family = &quot;family_sans&quot;) +
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="rweek2_files/figure-html/unnamed-chunk-12-5.png" width="672" /></p>
<pre class="r"><code>ggplot() +
  geom_point(aes(x, z)) +
  labs(title = &quot;散布図(x, z)&quot;) +
  theme_bw(base_family = &quot;family_sans&quot;) +
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="rweek2_files/figure-html/unnamed-chunk-12-6.png" width="672" /></p>
</div>
</div>
<div id="練習問題" class="section level2">
<h2>練習問題</h2>
<div id="問題2.1." class="section level3">
<h3>問題2.1.</h3>
<pre class="r"><code>#2.1.1.
runif(100)</code></pre>
<pre><code>##   [1] 0.61871065 0.62604032 0.44594072 0.26139383 0.96531894 0.62994919
##   [7] 0.51180644 0.17092798 0.38798116 0.17483592 0.48978980 0.52876386
##  [13] 0.26747844 0.85607675 0.98926293 0.16184444 0.09022702 0.80735863
##  [19] 0.23591288 0.88533651 0.22931029 0.87096117 0.86630033 0.83947200
##  [25] 0.04098152 0.25399755 0.90488741 0.08119359 0.16270397 0.36563850
##  [31] 0.36849111 0.27287593 0.67788535 0.59990959 0.43000617 0.90162256
##  [37] 0.12907406 0.95040128 0.26963551 0.71487853 0.31645751 0.57200621
##  [43] 0.73979460 0.92660800 0.75081161 0.59185234 0.29968510 0.24551649
##  [49] 0.90919693 0.30024007 0.44316080 0.62501128 0.38549136 0.17310310
##  [55] 0.87364124 0.96246023 0.12363348 0.93956516 0.99462077 0.10549780
##  [61] 0.35324895 0.84972873 0.34233737 0.52112348 0.36349922 0.81731858
##  [67] 0.38510142 0.38267297 0.63147262 0.78337203 0.32097847 0.69017538
##  [73] 0.07653559 0.57277068 0.88278534 0.72996516 0.58039146 0.50565493
##  [79] 0.45389612 0.17109780 0.66068112 0.87772499 0.03317746 0.32402934
##  [85] 0.50230193 0.88465604 0.34745028 0.43305052 0.88941203 0.86625496
##  [91] 0.04567937 0.70675477 0.91969079 0.91493140 0.98859407 0.87285245
##  [97] 0.85514820 0.88711221 0.87141426 0.58618239</code></pre>
<pre class="r"><code>#2.1.2.
P &lt;- runif(100)
mean(P) #平均</code></pre>
<pre><code>## [1] 0.5470838</code></pre>
<pre class="r"><code>var(P) #分散</code></pre>
<pre><code>## [1] 0.08708737</code></pre>
<pre class="r"><code>sd(P) #標準偏差</code></pre>
<pre><code>## [1] 0.2951057</code></pre>
<pre class="r"><code>#2.1.3.
S &lt;- 1000; n = 100
recP &lt;- numeric(S)
for(i in 1:S){recP[i] &lt;- mean(P)}
summary(recP)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.5471  0.5471  0.5471  0.5471  0.5471  0.5471</code></pre>
<pre class="r"><code>#Re
x &lt;- runif(100)
#2.1.2.
mean(x)</code></pre>
<pre><code>## [1] 0.4943941</code></pre>
<pre class="r"><code>var(x)</code></pre>
<pre><code>## [1] 0.08637215</code></pre>
<pre class="r"><code>sd(x)</code></pre>
<pre><code>## [1] 0.2938914</code></pre>
<pre class="r"><code>#2.1.3.
S &lt;- 1000; n &lt;- 1000
rec &lt;- numeric(S)
for(i in 1:S){rec[i] &lt;- mean(runif(n))}
summary(rec)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.4652  0.4935  0.5002  0.4999  0.5063  0.5264</code></pre>
</div>
<div id="問題2.2." class="section level3">
<h3>問題2.2.</h3>
<pre class="r"><code>x &lt;- runif(100)
y &lt;- rnorm(100, 0, 1)
z &lt;- 1.3*x-0.7*y

#2.2.1.
plot(x, y, main = &quot;散布図(x, y)&quot;)</code></pre>
<p><img src="rweek2_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre class="r"><code>plot(x, z, main = &quot;散布図(x, z)&quot;)</code></pre>
<p><img src="rweek2_files/figure-html/unnamed-chunk-14-2.png" width="672" /></p>
<pre class="r"><code>plot(y, z, main = &quot;散布図(y, z)&quot;)</code></pre>
<p><img src="rweek2_files/figure-html/unnamed-chunk-14-3.png" width="672" /></p>
<pre class="r"><code>cor(x, y)</code></pre>
<pre><code>## [1] 0.1622361</code></pre>
<pre class="r"><code>cor(x, z)</code></pre>
<pre><code>## [1] 0.3076427</code></pre>
<pre class="r"><code>cor(y, z)</code></pre>
<pre><code>## [1] -0.8889857</code></pre>
<pre class="r"><code>#2.2.2.
x &lt;- runif(n)
y &lt;- rnorm(n, 0, 1)
z &lt;- 1.3*x-0.7*y
n = 10000
cor(x, y)</code></pre>
<pre><code>## [1] 0.02079515</code></pre>
<pre class="r"><code>cor(x, z)</code></pre>
<pre><code>## [1] 0.4650723</code></pre>
<pre class="r"><code>cor(y, z)</code></pre>
<pre><code>## [1] -0.87541</code></pre>
<pre class="r"><code>par(mfrow = c(1,3))
plot(x, y, main = &quot;散布図(x, y)&quot;)
plot(x, z, main = &quot;散布図(x, z)&quot;)
plot(y, z, main = &quot;散布図(y, z)&quot;)</code></pre>
<p><img src="rweek2_files/figure-html/unnamed-chunk-14-4.png" width="672" /></p>
<pre class="r"><code>w &lt;- cbind(x, y, z)
cor(w)</code></pre>
<pre><code>##            x           y          z
## x 1.00000000  0.02079515  0.4650723
## y 0.02079515  1.00000000 -0.8754100
## z 0.46507231 -0.87541002  1.0000000</code></pre>
<pre class="r"><code>#おまけ
library(ggplot2)
x &lt;- runif(100)
y &lt;- rnorm(100, 0, 1)
z &lt;- 1.3*x-0.7*y

g1 &lt;- ggplot() +
  geom_point(aes(x, y)) +
  labs(title = &quot;散布図(x, y)&quot;) +
  theme_bw(base_family = &quot;family_sans&quot;) +
  theme(plot.title = element_text(hjust = 0.5))
g2 &lt;- ggplot() +
  geom_point(aes(x, z)) +
  labs(title = &quot;散布図(x, z)&quot;) +
  theme_bw(base_family = &quot;family_sans&quot;) +
  theme(plot.title = element_text(hjust = 0.5))
g3 &lt;- ggplot() +
  geom_point(aes(y, z)) +
  labs(title = &quot;散布図(y, z)&quot;) +
  theme_bw(base_family = &quot;family_sans&quot;) +
  theme(plot.title = element_text(hjust = 0.5))
grid.arrange(g1, g2, g3, ncol = 3)</code></pre>
<p><img src="rweek2_files/figure-html/unnamed-chunk-14-5.png" width="672" /></p>
</div>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li
id="fn1"><p>筒井淳也『数字のセンスを磨く　データの読み方・活かし方』（2023年,
光文社.）の第4章を参照のこと。<a href="#fnref1"
class="footnote-back">↩︎</a></p></li>
</ol>
</div>

<footer>
  <p>Copyright &copy; 2023- Naoshi ISAKI </p>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
